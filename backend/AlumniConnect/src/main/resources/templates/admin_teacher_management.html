<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Qu·∫£n l√Ω Gi·∫£ng vi√™n</title>

    <th:block th:insert="~{layout/base :: styleBase}"></th:block>
    <th:block th:insert="~{layout/base :: scriptBase}"></th:block>
</head>
<body>
    <header th:replace="~{layout/base :: header}"></header>

    <main class="container mt-4">
        <div class="card shadow-sm rounded-4 border-0">
            <div class="card-body">
                <h2 class="mb-4"><i class="bi bi-person-fill me-2"></i>Danh s√°ch Gi·∫£ng vi√™n</h2>

                <!-- Form t√¨m ki·∫øm -->
                <form th:action="@{/admin/teachers}" method="get" class="mb-4">
                    <div class="input-group">
                        <input type="text" class="form-control" name="username"
                               th:value="${username}" placeholder="üîç T√¨m theo m√£ gi·∫£ng vi√™n">
                        <button class="btn btn-outline-primary" type="submit"><i class="bi bi-search"></i> T√¨m</button>
                    </div>
                </form>

                <!-- N√∫t t·∫°o t√†i kho·∫£n gi·∫£ng vi√™n -->
                <div class="mb-3">
                    <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#createTeacherModal">
                        <i class="bi bi-person-plus-fill me-2"></i> T·∫°o t√†i kho·∫£n gi·∫£ng vi√™n
                    </button>
                </div>

                <!-- B·∫£ng danh s√°ch gi·∫£ng vi√™n -->
                <div class="table-responsive">
                    <table class="table table-hover align-middle">
                        <thead class="table-light">
                            <tr>
                                <th>#</th>
                                <th>M√£ gi·∫£ng vi√™n</th>
                                <th>H·ªç t√™n</th>
                                <th>Email</th>
                                <th>Tr·∫°ng th√°i</th>
                                <th>H√†nh ƒë·ªông</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="teacher, iterStat : ${teachers}">
                                <td th:text="${iterStat.count}"></td>
                                <td th:text="${teacher.userId.username}"></td>
                                <td th:text="${teacher.userId.firstName + ' ' + teacher.userId.lastName}"></td>
                                <td th:text="${teacher.userId.email}"></td>
                                <td>
                                    <span th:if="${teacher.mustChangePassword == false and teacher.userId.active == true}" 
                                          class="badge bg-success">ƒêang ho·∫°t ƒë·ªông</span>
                                    <span th:if="${teacher.mustChangePassword == true and teacher.userId.active == true}" 
                                          class="badge bg-warning">Ch·ªù x√°c nh·∫≠n</span>
                                    <span th:if="${teacher.mustChangePassword == false and teacher.userId.active == false}" 
                                          class="badge bg-secondary">ƒê√£ h·ªßy</span>
                                </td>
                                <td>
                                    <a th:href="@{/admin/teachers/edit/{id}(id=${teacher.id})}" 
                                       class="btn btn-warning btn-sm rounded-pill">
                                        <i class="bi bi-pencil-square me-1"></i> 
                                    </a>
                                    <a th:href="@{/admin/teachers/delete/{id}(id=${teacher.id})}" 
                                       class="btn btn-danger btn-sm rounded-pill"
                                       onclick="return confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a gi·∫£ng vi√™n n√†y kh√¥ng?');">
                                        <i class="bi bi-trash-fill me-1"></i> 
                                    </a>
                                    <button type="button" class="btn btn-info btn-sm rounded-pill"
                                            th:onclick="'updateResetPasswordTime(\'' + @{/admin/teachers/resetPassword/{id}(id=${teacher.id})} + '\')'">
                                        <i class="bi bi-clock-history me-1"></i>
                                    </button>


                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Ph√¢n trang -->
                <nav aria-label="Page navigation">
                    <ul class="pagination justify-content-center mt-4">
                        <li th:class="${currentPage > 1} ? 'page-item' : 'page-item disabled'">
                            <a class="page-link" th:href="@{/admin/teachers(page=${currentPage - 1}, size=${size}, username=${username})}">
                                <i class="bi bi-chevron-left"></i> Tr∆∞·ªõc
                            </a>
                        </li>
                        <li class="page-item disabled">
                            <span class="page-link" th:text="'Trang ' + ${currentPage} + ' / ' + ${totalPages}"></span>
                        </li>
                        <li th:class="${currentPage < totalPages} ? 'page-item' : 'page-item disabled'">
                            <a class="page-link" th:href="@{/admin/teachers(page=${currentPage + 1}, size=${size}, username=${username})}">
                                Ti·∫øp <i class="bi bi-chevron-right"></i>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>

        <!-- MODAL t·∫°o t√†i kho·∫£n gi·∫£ng vi√™n -->
        <div class="modal fade" id="createTeacherModal" tabindex="-1" aria-labelledby="createTeacherModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content shadow-lg rounded-4" style="background: #f8f9fa;">
                    <form id="createTeacherForm">
                        <!-- Header Modal -->
                        <div class="modal-header" style="background-color: #429279e6; color: white; border-radius: 15px 15px 0px 0px;">
                            <h5 class="modal-title" id="createTeacherModalLabel">T·∫°o t√†i kho·∫£n gi·∫£ng vi√™n m·ªõi</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ƒê√≥ng"></button>
                        </div>

                        <!-- Body Modal -->
                        <div class="modal-body">
                            <div class="row g-3">
                                <!-- M√£ Gi·∫£ng vi√™n -->
                                <div class="col-md-6">
                                    <label for="username" class="form-label">M√£ gi·∫£ng vi√™n</label>
                                    <input type="text" class="form-control" id="username" name="username" required placeholder="Nh·∫≠p m√£ gi·∫£ng vi√™n">
                                </div>
                                <!-- H·ªç -->
                                <div class="col-md-6">
                                    <label for="firstName" class="form-label">H·ªç</label>
                                    <input type="text" class="form-control" id="firstName" name="firstName" placeholder="Nh·∫≠p h·ªç c·ªßa gi·∫£ng vi√™n">
                                </div>
                                <!-- T√™n -->
                                <div class="col-md-6">
                                    <label for="lastName" class="form-label">T√™n</label>
                                    <input type="text" class="form-control" id="lastName" name="lastName" placeholder="Nh·∫≠p t√™n c·ªßa gi·∫£ng vi√™n">
                                </div>
                                <!-- Email -->
                                <div class="col-md-6">
                                    <label for="email" class="form-label">Email</label>
                                    <input type="email" class="form-control" id="email" name="email" required placeholder="Nh·∫≠p email c·ªßa gi·∫£ng vi√™n">
                                </div>
                                <!-- S·ªë ƒëi·ªán tho·∫°i -->
                                <div class="col-md-6">
                                    <label for="phone" class="form-label">S·ªë ƒëi·ªán tho·∫°i</label>
                                    <input type="text" class="form-control" id="phone" name="phone" placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i">
                                </div>

                            </div>
                        </div>

                        <!-- Footer Modal -->
                        <div class="modal-footer">
                            <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">H·ªßy</button>
                            <!-- N√∫t T·∫°o t√†i kho·∫£n -->
                            <button type="button" class="btn btn-primary" style="background-color: #329b5beb;" 
                                    th:onclick="'addTeacher(\'' + @{/admin/teachers/create} + '\')'">T·∫°o t√†i kho·∫£n</button>


                        </div>
                    </form>
                </div>
            </div>
        </div>



    </main>
<th:block th:insert="~{modal_noti}"></th:block>

<script th:src="@{/js/teacher.js}"></script>
<footer th:replace="~{layout/base :: footer}"></footer>
</body>
</html>
